function print_r(a,b,c,d){var e="";if(!b)b=0;if(!c)c="    ";if(!d)d="\n";var f="";for(var g=0;g<b+1;g++)f+=c;if(typeof a=="object"){for(var h in a){var i=a[h];if(typeof i=="object"){e+=f+"'"+h+"' :"+d;e+=print_r(i,b+1)}else e+=f+"'"+h+"' => \""+i+'"'+d}}else e="===>"+a+"<===("+typeof a+")";return e+d}function leadingZero(a,b){var c=""+a;while(c.length<b){c="0"+c}return c}(function(a){function b(){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(a)}else if(window.opera&&window.opera.postError){window.opera.postError(a)}}a.fn.experimmment=function(c,d){function E(a,b){function d(a,b){if(a.length<=3)return a;var c=a.length;var d="";var e=0;for(var f=c-1;f>=0;f--){var g=a.substr(f,1);if(e%3==0&&e!=0&&!isNaN(parseFloat(g)))d=b+d;d=g+d;e++}return d}function c(a,b){var c={};for(key in a){if(typeof b[key]!=="undefined")c[key]=b[key];else c[key]=a[key]}return c}if(typeof a!=="number"){a=parseFloat(a);if(isNaN(a))return false}var e={before:"",after:"",decimals:2,dec_point:".",thousands_sep:","};if(b&&typeof b==="object"){b=c(e,b)}else b=e;a=a.toFixed(b.decimals);if(a.indexOf(".")!=-1){var f=a.split(".");var a=d(f[0],b.thousands_sep)+b.dec_point+f[1]}else var a=d(a,b.thousands_sep);return b.before+a+b.after}function D(a,b){function c(a){if(a%10==1&&a%100!=11){return 0}else if(a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)){return 1}else{return 2}}if(typeof b=="undefined")return"";var d=c(Math.floor(a));if(typeof b[d]!="undefined"){return b[d]}else if(typeof b[1]!="undefined"){return b[1]}else if(typeof b[0]!="undefined"){return b[0]}}function C(a,b){if(typeof a=="string")a=new Date(a.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3"));if(typeof b=="string")b=new Date(b.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3"));b.setHours(a.getHours());b.setMinutes(a.getMinutes());b.setSeconds(a.getSeconds());var c=b>a?Math.ceil((b-a)/(1e3*60*60*24)):0;return c}function B(a,b){if(typeof b=="undefined")b=new Date;else if(typeof b=="string")b=new Date(b.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3"));b=b.getFullYear()+"-"+leadingZero(b.getMonth()+1,2)+"-"+leadingZero(b.getDate(),2);var c=0;jQuery.each(a,function(a,d){if(typeof e[b]!="undefined"){c+=Math.round(parseFloat(d)*parseFloat(e[b][a][1])*100)/100}});return c}function A(a,b){if(typeof a=="string")a=new Date(a.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3"));var d={};jQuery.each(c.money,function(){if(typeof d[this.dep]=="undefined"){d[this.dep]=0}var a=this.sum;var b=a;if(typeof f[this.dt]!="undefined"){jQuery.each(f[this.dt],function(c,d){b+=a*parseFloat(d)/100})}if(typeof e[this.dt]!="undefined"){d[this.dep]+=Math.round(b/parseFloat(e[this.dt][this.dep][0])*1e4)/1e4}});jQuery.each(c.additional,function(){if(typeof d[this.dep]=="undefined"){d[this.dep]=0}if(typeof e[this.dt]!="undefined"){d[this.dep]+=Math.round(this.sum/parseFloat(e[this.dt][this.dep][0])*1e4)/1e4}});return d}function z(){var a=c.currency;var b=c.template;b=b.replace(/:data/g,"<p>Вложил: :resultMoney :resultCurrencyMoney</p>"+"<p>Участвую в системе: :resultDays :resultStrDays</p>"+"<p>Уже в системе: :tplRealtime</p>"+"<p>Буду забирать через: :resultOutDays :resultStrOutDays</p>"+"<p>Получу: :resultOutMoney :resultCurrencyOutMoney</p>");b=b.replace(/:tplRealtime/g,c.tplRealtime);b=b.replace(/:resultMoney/g,E(n,{decimals:0,thousands_sep:"&#160;"}));b=b.replace(/:resultCurrencyMoney/g,D(n,h[a]));b=b.replace(/:resultDays/g,l);b=b.replace(/:resultStrDays/g,D(l,g));b=b.replace(/:resultMavroMoney/g,E(o,{decimals:0,thousands_sep:"&#160;"}));b=b.replace(/:resultCurrencyMavroMoney/g,D(o,h[a]));var d=Math.floor(o/n*100)-100;b=b.replace(/:resultGrowth/g,d);b=b.replace(/:resultOutMoney/g,E(p,{decimals:0,thousands_sep:"&#160;"}));b=b.replace(/:resultCurrencyOutMoney/g,D(p,h[a]));b=b.replace(/:resultOutDays/g,m);b=b.replace(/:resultStrOutDays/g,D(m,g));jQuery(i).html(b);if(c.realtime)y();if(typeof c.afterLoad=="function"){c.afterLoad()}}function y(){dtNow=new Date;secBefore=Math.ceil((dtNow-t)/1e3);secAfter=Math.ceil((u-dtNow)/1e3);secSum=secBefore+secAfter;periodMoney=q-o;s=periodMoney/secSum;r=o+s*secBefore;var a=c.tplRealtime;a=a.replace(/:resultMavroMoney/g,E(r,{decimals:2,thousands_sep:"&#160;",dec_point:'<span class="mmmDec">,'})+"</span>");a=a.replace(/:resultCurrencyMavroMoney/g,D(r,h[c.currency]));var b=Math.floor(r/n*100)-100;a=a.replace(/:resultGrowth/g,b);jQuery("span.mmmRealtime",i).html(a)}function x(a,b){t=new Date(a.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3 0:0:0"));u=new Date(b.replace(/(\d+)-(\d+)-(\d+)/,"$1/$2/$3 0:0:0"));window.setInterval(function(){y()},1e3)}function w(){var b="http://freedommm.me/rates.js?"+a.param({getRates:1,dt:v})+"&callback=?";jQuery.getJSON(b,function(a){e=a.rates;f=a.bonuses;o=B(A(j,true));p=B(A(c.dtCash,false),c.dtCash);q=B(A(a.tomorrow,false),a.tomorrow);if(c.realtime)x(a.yesterday,a.tomorrow);z()})}if(!this.length){b("Experimmment: no element selected");return this}var e=[];var f=[];var g={0:"день",1:"дня",2:"дней"};c=a.extend(true,{currency:"RUB",money:[],additional:[],dtRegistration:"2012-01-01",dtCash:"2012-12-21",template:":data",tplRealtime:'<span class="mmmRealtime">:resultMavroMoney :resultCurrencyMavroMoney (+:resultGrowth%)</span>',realtime:false,currencyPlural:{RUB:{0:"рубль",1:"рубля",2:"рублей"}}},c);var h=c.currencyPlural;var i=this;var j=new Date;var k=j.getFullYear()+"-"+leadingZero(j.getMonth()+1,2)+"-"+leadingZero(j.getDate(),2);var l=C(c.dtRegistration,j);var m=C(j,c.dtCash);var n=0;var o=0;var p=0;var q=0;var r=0;var s=0;var t,u;var v=[];jQuery.each(c.money,function(){n+=this.sum;v[v.length]=this.dt});jQuery.each(c.additional,function(){v[v.length]=this.dt});v[v.length]=k;v[v.length]=c.dtCash;w();return this};})(jQuery)